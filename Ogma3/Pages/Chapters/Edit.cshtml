@page
@using Utils.Extensions
@model Ogma3.Pages.Chapters.EditModel

@{
    ViewData["Title"] = "Edit Chapter";
}

<h1>@ViewData["Title"]</h1>

<div class="button-group">
    <a title="Cancel" class="action-btn large" asp-page="../Chapter" asp-route-id="@Model.Input.Id" asp-route-slug="@Model.Input.Title.Friendlify()">
         <icon class="icon" icon="arrow_back"></icon>
         <span class="name">Cancel</span>
     </a>
     <a title="Delete" class="action-btn large red" asp-page="./Delete" asp-route-id="@Model.Input.Id">
         <icon class="icon" icon="delete_forever"></icon>
         <span class="name">Delete</span>
     </a>
</div>

<div class="row">
    <div class="col-md-12">
        <form class="form" id="chapter" method="post" v-on:submit="onSubmit">
        
            <div asp-validation-summary="All">
                <span>Please correct the following errors</span>
            </div>
            
            <input-counter ref="title"
                :min="@(CTConfig.CChapter.MinTitleLength)"
                :max="@CTConfig.CChapter.MaxTitleLength"
                validate-msg="@CTConfig.CChapter.ValidateLengthMsg"
                label="@nameof(Model.Input.Title)"
                value="@Model.Input.Title">
            </input-counter>
            
            <textarea-counter ref="body"
                              :min="@CTConfig.CChapter.MinBodyLength"
                              :max="@CTConfig.CChapter.MaxBodyLength"
                              :wordcount="true"
                              :rows="20"
                              validate-msg="@CTConfig.CChapter.ValidateLengthMsg"
                              label="@nameof(Model.Input.Body)"
                              value="@Model.Input.Body">
            </textarea-counter>
            
            <textarea-counter ref="start-notes"
                              :max="@CTConfig.CChapter.MaxNotesLength"
                              validate-msg="@CTConfig.CChapter.ValidateNoteLengthMsg"
                              label="@nameof(Model.Input.StartNotes)"
                              value="@Model.Input.StartNotes">
            </textarea-counter>
            
            <textarea-counter ref="end-notes"
                              :max="@CTConfig.CChapter.MaxNotesLength"
                              validate-msg="@CTConfig.CChapter.ValidateNoteLengthMsg"
                              label="@nameof(Model.Input.EndNotes)"
                              value="@Model.Input.EndNotes">
            </textarea-counter>
    
            <input-toggle ref="published"
                          label="@nameof(Model.Input.Published)"
                          value="@Model.Input.Published"
                          desc="Control whether this chapter is visible or not">
            </input-toggle>
            
            <div class="o-form-group">
                <input type="submit" value="Save changes" class="btn btn-primary"/>
            </div>
            
        </form>
    </div>
</div>

@section Scripts {
    <script src="~/js/dist/components/input-counter-component.min.js" asp-append-version="true"></script>
    <script src="~/js/dist/components/textarea-counter-component.min.js" asp-append-version="true"></script> 
    <script src="~/js/dist/components/toggle-component.min.js" asp-append-version="true"></script>
    <script src="~/js/dist/editors/chapter.min.js" asp-append-version="true"></script>
}
