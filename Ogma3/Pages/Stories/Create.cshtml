@page
@using Ogma3.Api
@model Ogma3.Pages.Stories.CreateModel

@{
    ViewData["Title"] = "Create new story";
}

<h1>@ViewData["Title"]</h1>

<form class="form" id="story" method="post" enctype="multipart/form-data">

    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div class="o-form-group">
        <label asp-for="Input.Title"></label>
        <input asp-for="Input.Title" 
                placeholder="What your story be named" 
                class="o-form-control active-border" 
                v-model="title.current">
        <span class="counter">{{titleCount}}</span>
        <span asp-validation-for="Input.Title" class="text-warning"></span>
    </div>
    
    <div class="o-form-group">
        <label asp-for="Input.Description"></label>
        <textarea asp-for="Input.Description" 
                placeholder="What your story is about" 
                class="o-form-control active-border" 
                v-model="desc.current">
        </textarea>
        <span class="counter">{{descCount}}</span>
        <span asp-validation-for="Input.Description" class="text-warning"></span>
    </div>
    
    <div class="o-form-group">
        <label asp-for="Input.Hook"></label>
        <textarea asp-for="Input.Hook" 
                placeholder="The first thing visible on every list of stories" 
                class="o-form-control active-border"
                 v-model="hook.current">
        </textarea>
        <span class="counter">{{hookCount}}</span>
        <span asp-validation-for="Input.Hook" class="text-warning"></span>
    </div>
    
    <div class="o-form-group">
        <label asp-for="Input.Cover"></label>
        <p>First thing people often notice</p>
        <input asp-for="Input.Cover" 
                type="file" 
                class="o-form-control active-border">
        <span asp-validation-for="Input.Cover" class="text-warning"></span>
    </div>
    
    <div class="o-form-group">
        <label>Rating</label>
        <p>What audience is the story suitable for</p>
        
        <div class="ratings">
            @{ var first = true; }
            @foreach (var rating in Model.Ratings)
            {
                <div class="rating">
                    @if (first)
                    {
                        <input asp-for="Input.Rating" class="radio" type="radio" id="@rating.Name.ToLower()" value="@rating.Id" checked="checked">
                    }
                    else
                    {
                        <input asp-for="Input.Rating" class="radio" type="radio" id="@rating.Name.ToLower()" value="@rating.Id" >
                    }
                    <label class="radio-label active-border" for="@rating.Name.ToLower()">
                        <img src="@rating.Icon" alt="">
                        <div class="main">
                            <strong>@rating.Name</strong>
                            <span>@rating.Description</span>
                        </div>
                    </label>
                </div>
                first = false;
            }
        </div>
        <span asp-validation-for="Input.Rating" class="text-warning"></span>
        
    </div>
    
    @* TODO: Use https://jsfiddle.net/Angius/a86e13L2/31/ for multiselect *@
    
    <div class="o-form-group">
        <label asp-for="Input.Tags"></label>
        <p>To make the story easier to find</p>
        <select asp-for="Input.Tags" asp-items="Model.TagOptions" multiple="multiple" id="slim-select"></select>
        <span asp-validation-for="Input.Tags" class="text-warning"></span>
    </div>
        
    <button type="submit" class="btn btn-primary" >Create</button>
    
    <div id="route" style="background:indianred;padding:5rem" data-route="@Url.RouteUrl(nameof(TagsController))" v-if="!route"></div>
</form>


@section Scripts {
    <partial name="_ValidationScriptsPartial" />       
    <script src="/js/new-story.min.js" asp-append-version="true"></script>
}