{"version":3,"sources":["story.min.js"],"names":["story_vue","Vue","el","data","votesRoute","shelvesRoute","score","pool","didVote","storyId","shelves","showShelves","methods","vote","axios","post","this","votePool","Number","then","res","count","catch","console","error","getShelves","get","response","addToShelf","shelf","log","headers","RequestVerificationToken","csrf","[object Object]","document","getElementById","dataset","id","route","querySelector","value"],"mappings":"AAAA,IAAIA,UAAY,IAAIC,IAAI,CACpBC,GAAI,aACJC,KAAM,CACFC,WAAY,KACZC,aAAc,KAEdC,MAAO,EACPC,KAAM,KACNC,SAAS,EAETC,QAAS,KAETC,QAAS,GACTC,aAAa,GAEjBC,QAAS,CACLC,KAAM,WACFC,MAAMC,KAAKC,KAAKZ,WAAY,CACxBa,SAAUC,OAAOF,KAAKT,QAEzBY,KAAKC,IACFJ,KAAKV,MAAQc,EAAIjB,KAAKkB,MACtBL,KAAKR,QAAUY,EAAIjB,KAAKK,UAE3Bc,MAAMC,QAAQC,QAInBC,WAAY,WACRX,MAAMY,IAAIV,KAAKX,aAAe,SACzBc,KAAKQ,IACFX,KAAKN,QAAUiB,EAASxB,OAE3BmB,MAAMC,QAAQC,QAIvBI,WAAY,SAAUC,GAClBN,QAAQO,IAAID,EAAOb,KAAKP,SACxBK,MAAMC,KAAKC,KAAKX,aAAe,QAAUwB,EAAQ,IAAMb,KAAKP,QACxD,KACA,CACIsB,QAAS,CAAEC,yBAA6BhB,KAAKiB,QAEhDd,KAAKC,IACFG,QAAQO,IAAIV,EAAIjB,MAChBa,KAAKS,eAERH,MAAMC,QAAQC,SAG3BU,UAEIlB,KAAKT,KAAO4B,SAASC,eAAe,WAAWC,QAAQ9B,KACvDS,KAAKP,QAAU0B,SAASC,eAAe,YAAYC,QAAQC,GAE3DtB,KAAKZ,WAAa+B,SAASC,eAAe,eAAeC,QAAQE,MACjEvB,KAAKX,aAAe8B,SAASC,eAAe,iBAAiBC,QAAQE,MAErEvB,KAAKiB,KAAOE,SAASK,cAAc,yCAAyCC,MAE5E3B,MAAMY,IAAIV,KAAKZ,WAAa,IAAMY,KAAKT,MAClCY,KAAKC,IACFJ,KAAKV,MAAQc,EAAIjB,KAAKkB,MACtBL,KAAKR,QAAUY,EAAIjB,KAAKK,UAE3Bc,MAAMC,QAAQC,OAEnBR,KAAKS","file":"story.min.js","sourcesContent":["let story_vue = new Vue({\r\n    el: '#story-app',\r\n    data: {\r\n        votesRoute: null,\r\n        shelvesRoute: null,\r\n        \r\n        score: 0,\r\n        pool: null,\r\n        didVote: false,\r\n        \r\n        storyId: null,\r\n        \r\n        shelves: [],\r\n        showShelves: false\r\n    },\r\n    methods: {\r\n        vote: function() {\r\n            axios.post(this.votesRoute, {\r\n                votePool: Number(this.pool)\r\n            })\r\n            .then(res => {\r\n                this.score = res.data.count;\r\n                this.didVote = res.data.didVote;\r\n            })\r\n            .catch(console.error)\r\n        },\r\n        \r\n        // Gets all existing shelves\r\n        getShelves: function() {\r\n            axios.get(this.shelvesRoute + '/user')\r\n                .then(response => {\r\n                    this.shelves = response.data\r\n                })\r\n                .catch(console.error);\r\n        },\r\n        \r\n        // Add to bookshelf\r\n        addToShelf: function (shelf) {\r\n            console.log(shelf, this.storyId);\r\n            axios.post(this.shelvesRoute + \"/add/\" + shelf + \"/\" + this.storyId, \r\n                null,\r\n                {\r\n                    headers: { \"RequestVerificationToken\" : this.csrf }\r\n                })\r\n                .then(res => {\r\n                    console.log(res.data);\r\n                    this.getShelves();\r\n                })\r\n                .catch(console.error)\r\n        }\r\n    },\r\n    mounted() {\r\n        // Get pool and story IDs\r\n        this.pool = document.getElementById('pool-id').dataset.pool;\r\n        this.storyId = document.getElementById('story-id').dataset.id;\r\n        // Get routes\r\n        this.votesRoute = document.getElementById('votes-route').dataset.route;\r\n        this.shelvesRoute = document.getElementById('shelves-route').dataset.route;\r\n        // Get CSRF token\r\n        this.csrf = document.querySelector('input[name=__RequestVerificationToken').value;\r\n        // Get initial score\r\n        axios.get(this.votesRoute + '/' + this.pool)\r\n            .then(res => {\r\n                this.score = res.data.count;\r\n                this.didVote = res.data.didVote;\r\n            })\r\n            .catch(console.error);\r\n        // Get shelves\r\n        this.getShelves()\r\n    }\r\n});"]}