Vue.component("tag-search-select",{props:{min:{type:Number,default:0},label:{type:String,required:!0},desc:{type:String,required:!1,default:null},validateMsg:{type:String,default:null},tagsApi:{type:String,required:!0},storyId:{type:Number,default:null},preselected:{type:Array,default:null},inline:{type:Boolean,default:!1}},data:function(){return{name:this.label.replace(/\s+/g,"").toLowerCase(),loading:!0,options:[],selected:[],search:"",highlighted:null,focused:!1}},computed:{validate:function(){return this.selected.length>=this.min},validationString:function(){return this.validateMsg.replace("{0}",""+this.min)},filtered(){return this.options.filter(e=>(e.name.toLowerCase().includes(this.search.toLowerCase())||e.namespace.toLowerCase().includes(this.search.toLowerCase()))&&!this.selected.some(t=>t.id===e.id)&&this.search.length>0)}},methods:{handleInputKeys:function(e){switch(e.key){case"Backspace":this.search.length<=0&&this.selected.pop();break;case"ArrowUp":null!==this.highlighted&&e.preventDefault(),this.highlighted>0?this.highlighted--:this.highlighted=null;break;case"ArrowDown":null!==this.highlighted&&e.preventDefault(),null===this.highlighted?this.highlighted=0:this.highlighted<this.filtered.length-1&&this.highlighted++;break;case" ":case"Enter":null!==this.highlighted&&(e.preventDefault(),this.highlighted=0,this.selected.pushUnique(JSON.parse(JSON.stringify(this.filtered[this.highlighted]))))}}},created(){axios.get(this.tagsApi).then(e=>{this.options=e.data,this.loading=!1,this.storyId&&axios.get(`${this.tagsApi}/story/${this.storyId}`).then(e=>{this.selected=e.data,this.selected.forEach(e=>this.options.find(t=>t.id===e.id).hidden=!0)}).catch(console.error),this.preselected&&(this.selected=this.options.filter(e=>-1!==this.preselected.indexOf(e.id)))}).catch(console.error)},template:'\n        <div class="tag-search-select"\n             v-on:focusin="focused = true">\n            <select class="output" :name="name" multiple="multiple" :id="name">\n                <option v-for="s in selected" :value="s.id" selected>{{s.name}}</option>\n            </select>\n    \n            <div class="o-form-group tag-search" :class="inline ? \'inline\' : null">\n                <label :for="name">{{label.replace( /([A-Z])/g, " $1" )}}</label>\n                <p class="desc" v-if="desc && !inline">{{desc}}</p>\n    \n                <div class="searchbar">\n                  <div class="tags">\n                    \n                    <div class="tag" v-bind:style="{background: s.rgba}" v-for="s in selected">\n                      {{s.namespace ? s.namespace+\':\' : \'\'}}{{s.name}}\n                      <i class="material-icons-outlined" v-on:click="selected.remove(s)">clear</i>\n                    </div>\n                    \n                    <input type="text"\n                           class="search"\n                           v-model="search"\n                           v-on:keydown="handleInputKeys"\n                           placeholder="Search...">\n                  </div>\n\n                  <ol v-if="!loading && focused" class="search-results">\n                    <li v-for="(o, idx) in filtered"\n                        :style="{background: o.rgba}"\n                        :class="highlighted === idx ? \'hl\' : null"\n                        v-on:click="selected.pushUnique(o)">\n                      <span class="name">{{o.namespace ? o.namespace+\':\' : \'\'}}{{o.name}}</span>\n                    </li>\n                  </ol>\n                </div>\n    \n            </div>\n\n            <span v-if="!validate && validateMsg">{{validationString}}</span>\n        </div>\n    '});
//# sourceMappingURL=tag-search-select-component.min.js.map
