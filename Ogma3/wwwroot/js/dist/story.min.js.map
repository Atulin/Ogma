{"version":3,"sources":["story.min.js"],"names":["story_vue","Vue","el","data","votesRoute","shelvesRoute","csrf","score","pool","didVote","storyId","shelves","showShelves","methods","vote","axios","post","this","votePool","Number","then","res","count","catch","console","error","getShelves","get","response","addToShelf","shelf","log","headers","RequestVerificationToken","[object Object]","document","getElementById","dataset","id","route","querySelector","value"],"mappings":"AAAA,IAAIA,UAAY,IAAIC,IAAI,CACpBC,GAAI,aACJC,KAAM,CACFC,WAAY,KACZC,aAAc,KACdC,KAAM,KAENC,MAAO,EACPC,KAAM,KACNC,SAAS,EAETC,QAAS,KAETC,QAAS,GACTC,aAAa,GAEjBC,QAAS,CACLC,KAAM,WACFC,MAAMC,KAAKC,KAAKb,WAAY,CACxBc,SAAUC,OAAOF,KAAKT,QAEzBY,KAAKC,IACFJ,KAAKV,MAAQc,EAAIlB,KAAKmB,MACtBL,KAAKR,QAAUY,EAAIlB,KAAKM,UAE3Bc,MAAMC,QAAQC,QAInBC,WAAY,WACRX,MAAMY,IAAIV,KAAKZ,aAAe,SAAWY,KAAKP,SACzCU,KAAKQ,IACFX,KAAKN,QAAUiB,EAASzB,OAE3BoB,MAAMC,QAAQC,QAIvBI,WAAY,SAAUC,GAClBN,QAAQO,IAAID,EAAOb,KAAKP,SACxBK,MAAMC,KAAKC,KAAKZ,aAAe,QAAUyB,EAAQ,IAAMb,KAAKP,QACxD,KACA,CACIsB,QAAS,CAAEC,yBAA6BhB,KAAKX,QAEhDc,KAAKC,IACFJ,KAAKS,eAERH,MAAMC,QAAQC,SAG3BS,UAEIjB,KAAKT,KAAOW,OAAOgB,SAASC,eAAe,WAAWC,QAAQ7B,MAC9DS,KAAKP,QAAUS,OAAOgB,SAASC,eAAe,YAAYC,QAAQC,IAElErB,KAAKb,WAAa+B,SAASC,eAAe,eAAeC,QAAQE,MACjEtB,KAAKZ,aAAe8B,SAASC,eAAe,iBAAiBC,QAAQE,MAErEtB,KAAKX,KAAO6B,SAASK,cAAc,yCAAyCC,MAE5E1B,MAAMY,IAAIV,KAAKb,WAAa,IAAMa,KAAKT,MAClCY,KAAKC,IACFJ,KAAKV,MAAQc,EAAIlB,KAAKmB,MACtBL,KAAKR,QAAUY,EAAIlB,KAAKM,UAE3Bc,MAAMC,QAAQC,OAEnBR,KAAKS","file":"story.min.js","sourcesContent":["let story_vue = new Vue({\r\n    el: '#story-app',\r\n    data: {\r\n        votesRoute: null,\r\n        shelvesRoute: null,\r\n        csrf: null,\r\n        \r\n        score: 0,\r\n        pool: null,\r\n        didVote: false,\r\n        \r\n        storyId: null,\r\n        \r\n        shelves: [],\r\n        showShelves: false\r\n    },\r\n    methods: {\r\n        vote: function() {\r\n            axios.post(this.votesRoute, {\r\n                votePool: Number(this.pool)\r\n            })\r\n            .then(res => {\r\n                this.score = res.data.count;\r\n                this.didVote = res.data.didVote;\r\n            })\r\n            .catch(console.error)\r\n        },\r\n        \r\n        // Gets all existing shelves\r\n        getShelves: function() {\r\n            axios.get(this.shelvesRoute + '/user/' + this.storyId)\r\n                .then(response => {\r\n                    this.shelves = response.data\r\n                })\r\n                .catch(console.error);\r\n        },\r\n        \r\n        // Add to bookshelf\r\n        addToShelf: function (shelf) {\r\n            console.log(shelf, this.storyId);\r\n            axios.post(this.shelvesRoute + \"/add/\" + shelf + \"/\" + this.storyId, \r\n                null,\r\n                {\r\n                    headers: { \"RequestVerificationToken\" : this.csrf }\r\n                })\r\n                .then(res => {\r\n                    this.getShelves();\r\n                })\r\n                .catch(console.error)\r\n        }\r\n    },\r\n    mounted() {\r\n        // Get pool and story IDs\r\n        this.pool = Number(document.getElementById('pool-id').dataset.pool);\r\n        this.storyId = Number(document.getElementById('story-id').dataset.id);\r\n        // Get routes\r\n        this.votesRoute = document.getElementById('votes-route').dataset.route;\r\n        this.shelvesRoute = document.getElementById('shelves-route').dataset.route;\r\n        // Get CSRF token\r\n        this.csrf = document.querySelector('input[name=__RequestVerificationToken').value;\r\n        // Get initial score\r\n        axios.get(this.votesRoute + '/' + this.pool)\r\n            .then(res => {\r\n                this.score = res.data.count;\r\n                this.didVote = res.data.didVote;\r\n            })\r\n            .catch(console.error);\r\n        // Get shelves\r\n        this.getShelves()\r\n    }\r\n});"]}