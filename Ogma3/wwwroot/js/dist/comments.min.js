let comments_vue=new Vue({el:"#comments-container",data:{body:null,thread:null,route:null,csrf:null,comments:[],total:0,page:null,perPage:null,highlight:null},methods:{submit:function(t){t.preventDefault(),axios.post(this.route,{body:this.body,thread:Number(this.thread)},{headers:{RequestVerificationToken:this.csrf}}).then(t=>{this.highlight=1,this.load(),this.body=null}).catch(console.error)},load:function(){const t={thread:this.thread,page:this.page,highlight:this.highlight};axios.get(this.route,{params:t}).then(t=>{this.total=t.data.total,this.page=t.data.page??this.page,this.comments=t.data.elements.map((e,i)=>({val:e,key:t.data.total-(i+(this.page-1)*this.perPage)})),this.highlight?Vue.nextTick(t=>comments_vue.changeHighlight()):this.navigateToPage()}).catch(console.error)},enter:function(t){t.ctrlKey&&this.submit(t)},date:function(t){return dayjs(t).format("DD MMM YYYY, HH:mm")},prevPage:function(){let t=Math.max(1,this.page-1);this.changePage(t)},nextPage:function(){let t=Math.min(this.page+1,Math.ceil(this.total/this.perPage));this.changePage(t)},changePage:function(t){this.page=t,this.navigateToPage(),this.load()},changeHighlight:function(t=null,e=null){e&&e.preventDefault(),this.highlight=t??this.highlight,document.getElementById("comment-"+this.highlight).scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),history.replaceState(void 0,void 0,"#comment-"+this.highlight)},navigateToPage:function(){this.page>1?history.replaceState(null,null,"#page-"+this.page):history.replaceState(null,null,window.location.href.split("#")[0]),this.highlight&&(this.highlight=null)}},mounted(){this.thread=document.getElementById("thread").dataset.thread,this.route=document.getElementById("route").dataset.route,this.perPage=document.getElementById("per-page").dataset.count,this.csrf=document.querySelector("input[name=__RequestVerificationToken]").value;let t=window.location.hash.split("-");"#page"===t[0]&&t[1]?this.page=Math.max(1,Number(t[1]??1)):"#comment"===t[0]&&t[1]?(this.page=1,this.highlight=Number(t[1])):(this.page=1,history.replaceState(void 0,void 0,"")),this.load()}});
//# sourceMappingURL=comments.min.js.map
